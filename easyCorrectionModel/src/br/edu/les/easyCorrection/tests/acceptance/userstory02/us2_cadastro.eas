#--------------------------------------------------------------------------------------------
# Teste de Aceitação do sistema easyLabCorrection
# Equipe de Desenvolvimento:
# ----- Alysson Filgueira
# ----- Augusto Macedo
# ----- Demetrio Mestre
#--------------------------------------------------------------------------------------------

#####################################################################################
# Caso de Uso 2: Controle de Acesso: 
# Funcionalidade que permite o GRUD de menus, funções, grupos e usuários no sistema.
#####################################################################################

#####################################################################################
# testes de setup: temos um controle de acesso adequado? menus, funções, grupos e 
# usuários.
#####################################################################################

# ------- Setup de Menus -----------

#gravar e ler
idMenu=cadastrarMenu nome="MenuTeste1" rotulo="menuTeste1"
expect "MenuTeste1" getAtributoMenu id=${idMenu} atributo=nome
expect "menuTeste1" getAtributoMenu id=${idMenu} atributo=rotulo
expectError "menu nao foi encontrado(a)." getMenu id=999

idMenu2=cadastrarMenu nome="MenuTeste2" rotulo="avaliacao"
expectDifferent ${idMenu} echo ${iMenu2}

idMenu3=cadastrarMenu nome="MenuTeste3" rotulo="menu3"
idMenu4=cadastrarMenu nome="qualquer" rotulo="null"
expectDifferent ${idMenu3} echo ${iMenu4}
idMenu5=cadastrarMenu nome="qualquer" rotulo="nomeAlgum"
idMenu6=cadastrarMenu nome="" rotulo="nomeAlg"
idMenu7=cadastrarMenu nome="algumNome" rotulo=""

expect ${idMenu} editarMenu id=${idMenu} nome="nomeAlterado1" rotulo="rotuloAlterado1"
expect ${idMenu2} editarMenu id=${idMenu2} nome="nomeAlterado2" rotulo="rotuloAlterado2"
expect ${idMenu3} editarMenu id=${idMenu3} nome="nomeAlterado3" rotulo="rotuloAlterado3"
expect ${idMenu4} editarMenu id=${idMenu4} nome="nomeAlterado4" rotulo="rotuloAlterado4"
expect ${idMenu5} editarMenu id=${idMenu5} nome="nomeAlterado5" rotulo="rotuloAlterado5"

expect "nomeAlterado2" getAtributoMenu id=${idMenu2} atributo=nome
expect "rotuloAlterado3" getAtributoMenu id=${idMenu3} atributo=rotulo
expect ${idMenu4} getAtributoMenu id=${idMenu4} atributo=idMenu
expect "nomeAlterado1" getAtributoMenuListaMenus id=${idMenu} atributo=nome
expect "rotuloAlterado2" getAtributoMenuListaMenus id=${idMenu2} atributo=rotulo
expect "nomeAlterado3" getAtributoMenuListaMenus id=${idMenu3} atributo=nome
expect ${idMenu5} getAtributoMenuListaMenus id=${idMenu5} atributo=idMenu
expect "Menu Inexistente." getAtributoMenuListaMenus id=999 atributo=nome

# ------- Setup de Funções -----------

#gravar e ler
idFuncao=cadastrarFuncao nome="FuncaoTeste1" rotulo="FuncaoTeste1" idMenu=${idMenu}
expect "FuncaoTeste1" getAtributoFuncao id=${idFuncao} atributo=nome
expect "FuncaoTeste1" getAtributoFuncao id=${idFuncao} atributo=rotulo
expectError "funcao nao foi encontrado(a)." getFuncao id=999

idFuncao2=cadastrarFuncao nome="FuncaoTeste2" rotulo="avaliacao" idMenu=${idMenu2}
expectDifferent ${idFuncao} echo ${iFuncao2}

idFuncao3=cadastrarFuncao nome="FuncaoTeste3" rotulo="Funcao3" idMenu=${idMenu3}
idFuncao4=cadastrarFuncao nome="qualquer" rotulo="null" idMenu=${idMenu4}
expectDifferent ${idFuncao3} echo ${iFuncao4}
idFuncao5=cadastrarFuncao nome="qualquer" rotulo="nomeAlgum" idMenu=${idMenu5}
idFuncao6=cadastrarFuncao nome="no" rotulo="nomeAlg" idMenu=${idMenu6}
idFuncao7=cadastrarFuncao nome="algumNome" rotulo="" idMenu=${idMenu7}

expect ${idFuncao} editarFuncao id=${idFuncao} nome="nomeAlterado1" rotulo="rotuloAlterado1" idMenu=${idMenu5}
expect ${idFuncao2} editarFuncao id=${idFuncao2} nome="nomeAlterado2" rotulo="rotuloAlterado2" idMenu=${idMenu5}
expect ${idFuncao3} editarFuncao id=${idFuncao3} nome="nomeAlterado3" rotulo="rotuloAlterado3" idMenu=${idMenu5}
expect ${idFuncao4} editarFuncao id=${idFuncao4} nome="nomeAlterado4" rotulo="rotuloAlterado4" idMenu=${idMenu5}
expect ${idFuncao5} editarFuncao id=${idFuncao5} nome="nomeAlterado5" rotulo="rotuloAlterado5" idMenu=${idMenu5}

expect "nomeAlterado2" getAtributoFuncao id=${idFuncao2} atributo=nome
expect "rotuloAlterado3" getAtributoFuncao id=${idFuncao3} atributo=rotulo
expect ${idFuncao4} getAtributoFuncao id=${idFuncao4} atributo=idFuncao
expect "nomeAlterado1" getAtributoFuncaoListaFuncoes id=${idFuncao} atributo=nome
expect "rotuloAlterado2" getAtributoFuncaoListaFuncoes id=${idFuncao2} atributo=rotulo
expect "nomeAlterado3" getAtributoFuncaoListaFuncoes id=${idFuncao3} atributo=nome
expect ${idFuncao5} getAtributoFuncaoListaFuncoes id=${idFuncao5} atributo=idFuncao
expect "Funcao Inexistente." getAtributoFuncaoListaFuncoes id=999 atributo=nome

#####################################################################################
# Para ver as alterações no Banco de Dados comente as linhas seguintes.
#####################################################################################

excluirFuncao idFuncao=${idFuncao}
excluirFuncao idFuncao=${idFuncao2}
excluirFuncao idFuncao=${idFuncao3}
excluirFuncao idFuncao=${idFuncao4}
excluirFuncao idFuncao=${idFuncao5}
excluirFuncao idFuncao=${idFuncao6}
excluirFuncao idFuncao=${idFuncao7}

excluirMenu idMenu=${idMenu}
excluirMenu idMenu=${idMenu2}
excluirMenu idMenu=${idMenu3}
excluirMenu idMenu=${idMenu4}
excluirMenu idMenu=${idMenu5}
excluirMenu idMenu=${idMenu6}
excluirMenu idMenu=${idMenu7}